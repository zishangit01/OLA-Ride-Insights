CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `ola_analytics`.`vw_overall_kpi` AS select count(0) AS `total_bookings`,sum((case when (`ola_analytics`.`vw_ola_clean`.`Booking_Status` = 'Success') then 1 else 0 end)) AS `successful_bookings`,sum(`ola_analytics`.`vw_ola_clean`.`Is_Cancelled`) AS `cancelled_bookings`,round(((sum(`ola_analytics`.`vw_ola_clean`.`Is_Cancelled`) * 100.0) / count(0)),2) AS `cancellation_rate_pct`,sum(`ola_analytics`.`vw_ola_clean`.`Booking_Value`) AS `total_booking_value`,sum((case when (`ola_analytics`.`vw_ola_clean`.`Is_Cancelled` = 1) then `ola_analytics`.`vw_ola_clean`.`Booking_Value` else 0 end)) AS `lost_revenue_due_to_cancellation` from `ola_analytics`.`vw_ola_clean`;
