CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `ola_analytics`.`vw_vehicle_risk` AS select `ola_analytics`.`vw_ola_clean`.`Vehicle_Type` AS `Vehicle_Type`,count(0) AS `total_rides`,sum(`ola_analytics`.`vw_ola_clean`.`Is_Cancelled`) AS `cancelled_rides`,round(((sum(`ola_analytics`.`vw_ola_clean`.`Is_Cancelled`) * 100.0) / count(0)),2) AS `cancel_pct`,sum((case when (`ola_analytics`.`vw_ola_clean`.`Is_Cancelled` = 1) then `ola_analytics`.`vw_ola_clean`.`Booking_Value` else 0 end)) AS `lost_revenue` from `ola_analytics`.`vw_ola_clean` group by `ola_analytics`.`vw_ola_clean`.`Vehicle_Type`;
